{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sleep = exports.convert = exports.formatPct = exports.formatNumber = exports.formatUSD = exports.formatTokenAmount = exports.formatAmount = exports.tryParseKey = exports.fromLamports = exports.wadToLamports = exports.toLamports = exports.chunks = exports.STABLE_COINS = exports.isKnownMint = exports.getTokenIcon = exports.getTokenByName = exports.getVerboseTokenName = exports.getTokenName = exports.shortenAddress = exports.findProgramAddress = exports.useLocalStorageState = exports.formatPriceNumber = void 0;\n\nconst react_1 = require(\"react\");\n\nconst web3_js_1 = require(\"@solana/web3.js\");\n\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n\nconst constants_1 = require(\"../constants\");\n\nconst useLocalStorage_1 = require(\"./useLocalStorage\");\n\nexports.formatPriceNumber = new Intl.NumberFormat('en-US', {\n  style: 'decimal',\n  minimumFractionDigits: 2,\n  maximumFractionDigits: 8\n});\n\nfunction useLocalStorageState(key, defaultState) {\n  const localStorage = useLocalStorage_1.useLocalStorage();\n  const [state, setState] = react_1.useState(() => {\n    // NOTE: Not sure if this is ok\n    const storedState = localStorage.getItem(key);\n\n    if (storedState) {\n      return JSON.parse(storedState);\n    }\n\n    return defaultState;\n  });\n  const setLocalStorageState = react_1.useCallback(newState => {\n    const changed = state !== newState;\n\n    if (!changed) {\n      return;\n    }\n\n    setState(newState);\n\n    if (newState === null) {\n      localStorage.removeItem(key);\n    } else {\n      try {\n        localStorage.setItem(key, JSON.stringify(newState));\n      } catch {// ignore\n      }\n    }\n  }, [state, key]);\n  return [state, setLocalStorageState];\n}\n\nexports.useLocalStorageState = useLocalStorageState;\n\nconst findProgramAddress = async (seeds, programId) => {\n  const localStorage = useLocalStorage_1.useLocalStorage();\n  const key = 'pda-' + seeds.reduce((agg, item) => agg + item.toString('hex'), '') + programId.toString();\n  const cached = localStorage.getItem(key);\n\n  if (cached) {\n    const value = JSON.parse(cached);\n    return [value.key, parseInt(value.nonce)];\n  }\n\n  const result = await web3_js_1.PublicKey.findProgramAddress(seeds, programId);\n\n  try {\n    localStorage.setItem(key, JSON.stringify({\n      key: result[0].toBase58(),\n      nonce: result[1]\n    }));\n  } catch {// ignore\n  }\n\n  return [result[0].toBase58(), result[1]];\n};\n\nexports.findProgramAddress = findProgramAddress; // shorten the checksummed version of the input address to have 4 characters at start and end\n\nfunction shortenAddress(address, chars = 4) {\n  return `${address.slice(0, chars)}...${address.slice(-chars)}`;\n}\n\nexports.shortenAddress = shortenAddress;\n\nfunction getTokenName(map, mint, shorten = true) {\n  var _a;\n\n  const mintAddress = typeof mint === 'string' ? mint : mint === null || mint === void 0 ? void 0 : mint.toBase58();\n\n  if (!mintAddress) {\n    return 'N/A';\n  }\n\n  const knownSymbol = (_a = map.get(mintAddress)) === null || _a === void 0 ? void 0 : _a.symbol;\n\n  if (knownSymbol) {\n    return knownSymbol;\n  }\n\n  return shorten ? `${mintAddress.substring(0, 5)}...` : mintAddress;\n}\n\nexports.getTokenName = getTokenName;\n\nfunction getVerboseTokenName(map, mint, shorten = true) {\n  var _a;\n\n  const mintAddress = typeof mint === 'string' ? mint : mint === null || mint === void 0 ? void 0 : mint.toBase58();\n\n  if (!mintAddress) {\n    return 'N/A';\n  }\n\n  const knownName = (_a = map.get(mintAddress)) === null || _a === void 0 ? void 0 : _a.name;\n\n  if (knownName) {\n    return knownName;\n  }\n\n  return shorten ? `${mintAddress.substring(0, 5)}...` : mintAddress;\n}\n\nexports.getVerboseTokenName = getVerboseTokenName;\n\nfunction getTokenByName(tokenMap, name) {\n  let token = null;\n\n  for (const val of tokenMap.values()) {\n    if (val.symbol === name) {\n      token = val;\n      break;\n    }\n  }\n\n  return token;\n}\n\nexports.getTokenByName = getTokenByName;\n\nfunction getTokenIcon(map, mintAddress) {\n  var _a;\n\n  const address = typeof mintAddress === 'string' ? mintAddress : mintAddress === null || mintAddress === void 0 ? void 0 : mintAddress.toBase58();\n\n  if (!address) {\n    return;\n  }\n\n  return (_a = map.get(address)) === null || _a === void 0 ? void 0 : _a.logoURI;\n}\n\nexports.getTokenIcon = getTokenIcon;\n\nfunction isKnownMint(map, mintAddress) {\n  return !!map.get(mintAddress);\n}\n\nexports.isKnownMint = isKnownMint;\nexports.STABLE_COINS = new Set(['USDC', 'wUSDC', 'USDT']);\n\nfunction chunks(array, size) {\n  return Array.apply(0, new Array(Math.ceil(array.length / size))).map((_, index) => array.slice(index * size, (index + 1) * size));\n}\n\nexports.chunks = chunks;\n\nfunction toLamports(account, mint) {\n  var _a;\n\n  if (!account) {\n    return 0;\n  }\n\n  const amount = typeof account === 'number' ? account : (_a = account.info.amount) === null || _a === void 0 ? void 0 : _a.toNumber();\n  const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 0);\n  return Math.floor(amount * precision);\n}\n\nexports.toLamports = toLamports;\n\nfunction wadToLamports(amount) {\n  return (amount === null || amount === void 0 ? void 0 : amount.div(constants_1.WAD)) || constants_1.ZERO;\n}\n\nexports.wadToLamports = wadToLamports;\n\nfunction fromLamports(account, mint, rate = 1.0) {\n  if (!account) {\n    return 0;\n  }\n\n  const amount = Math.floor(typeof account === 'number' ? account : bn_js_1.default.isBN(account) ? account.toNumber() : account.info.amount.toNumber());\n  const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 9);\n  return amount / precision * rate;\n}\n\nexports.fromLamports = fromLamports;\n\nconst tryParseKey = key => {\n  try {\n    return new web3_js_1.PublicKey(key);\n  } catch (error) {\n    return null;\n  }\n};\n\nexports.tryParseKey = tryParseKey;\nconst SI_SYMBOL = ['', 'k', 'M', 'G', 'T', 'P', 'E'];\n\nconst abbreviateNumber = (number, precision) => {\n  const tier = Math.log10(number) / 3 | 0;\n  let scaled = number;\n  const suffix = SI_SYMBOL[tier];\n\n  if (tier !== 0) {\n    const scale = Math.pow(10, tier * 3);\n    scaled = number / scale;\n  }\n\n  return scaled.toFixed(precision) + suffix;\n};\n\nconst formatAmount = (val, precision = 2, abbr = true) => abbr ? abbreviateNumber(val, precision) : val.toFixed(precision);\n\nexports.formatAmount = formatAmount;\n\nfunction formatTokenAmount(account, mint, rate = 1.0, prefix = '', suffix = '', precision = 2, abbr = false) {\n  if (!account) {\n    return '';\n  }\n\n  return `${[prefix]}${exports.formatAmount(fromLamports(account, mint, rate), precision, abbr)}${suffix}`;\n}\n\nexports.formatTokenAmount = formatTokenAmount;\nexports.formatUSD = new Intl.NumberFormat('en-US', {\n  style: 'currency',\n  currency: 'USD'\n});\nconst numberFormater = new Intl.NumberFormat('en-US', {\n  style: 'decimal',\n  minimumFractionDigits: 2,\n  maximumFractionDigits: 2\n});\nexports.formatNumber = {\n  format: val => {\n    if (!val) {\n      return '--';\n    }\n\n    return numberFormater.format(val);\n  }\n};\nexports.formatPct = new Intl.NumberFormat('en-US', {\n  style: 'percent',\n  minimumFractionDigits: 2,\n  maximumFractionDigits: 2\n});\n\nfunction convert(account, mint, rate = 1.0) {\n  var _a;\n\n  if (!account) {\n    return 0;\n  }\n\n  const amount = typeof account === 'number' ? account : (_a = account.info.amount) === null || _a === void 0 ? void 0 : _a.toNumber();\n  const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 0);\n  const result = amount / precision * rate;\n  return result;\n}\n\nexports.convert = convert;\n\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexports.sleep = sleep;","map":{"version":3,"sources":["../../../src/utils/utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.sleep = exports.convert = exports.formatPct = exports.formatNumber = exports.formatUSD = exports.formatTokenAmount = exports.formatAmount = exports.tryParseKey = exports.fromLamports = exports.wadToLamports = exports.toLamports = exports.chunks = exports.STABLE_COINS = exports.isKnownMint = exports.getTokenIcon = exports.getTokenByName = exports.getVerboseTokenName = exports.getTokenName = exports.shortenAddress = exports.findProgramAddress = exports.useLocalStorageState = exports.formatPriceNumber = void 0;\r\nconst react_1 = require(\"react\");\r\nconst web3_js_1 = require(\"@solana/web3.js\");\r\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\r\nconst constants_1 = require(\"../constants\");\r\nconst useLocalStorage_1 = require(\"./useLocalStorage\");\r\nexports.formatPriceNumber = new Intl.NumberFormat('en-US', {\r\n    style: 'decimal',\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 8,\r\n});\r\nfunction useLocalStorageState(key, defaultState) {\r\n    const localStorage = useLocalStorage_1.useLocalStorage();\r\n    const [state, setState] = react_1.useState(() => {\r\n        // NOTE: Not sure if this is ok\r\n        const storedState = localStorage.getItem(key);\r\n        if (storedState) {\r\n            return JSON.parse(storedState);\r\n        }\r\n        return defaultState;\r\n    });\r\n    const setLocalStorageState = react_1.useCallback(newState => {\r\n        const changed = state !== newState;\r\n        if (!changed) {\r\n            return;\r\n        }\r\n        setState(newState);\r\n        if (newState === null) {\r\n            localStorage.removeItem(key);\r\n        }\r\n        else {\r\n            try {\r\n                localStorage.setItem(key, JSON.stringify(newState));\r\n            }\r\n            catch {\r\n                // ignore\r\n            }\r\n        }\r\n    }, [state, key]);\r\n    return [state, setLocalStorageState];\r\n}\r\nexports.useLocalStorageState = useLocalStorageState;\r\nconst findProgramAddress = async (seeds, programId) => {\r\n    const localStorage = useLocalStorage_1.useLocalStorage();\r\n    const key = 'pda-' +\r\n        seeds.reduce((agg, item) => agg + item.toString('hex'), '') +\r\n        programId.toString();\r\n    const cached = localStorage.getItem(key);\r\n    if (cached) {\r\n        const value = JSON.parse(cached);\r\n        return [value.key, parseInt(value.nonce)];\r\n    }\r\n    const result = await web3_js_1.PublicKey.findProgramAddress(seeds, programId);\r\n    try {\r\n        localStorage.setItem(key, JSON.stringify({\r\n            key: result[0].toBase58(),\r\n            nonce: result[1],\r\n        }));\r\n    }\r\n    catch {\r\n        // ignore\r\n    }\r\n    return [result[0].toBase58(), result[1]];\r\n};\r\nexports.findProgramAddress = findProgramAddress;\r\n// shorten the checksummed version of the input address to have 4 characters at start and end\r\nfunction shortenAddress(address, chars = 4) {\r\n    return `${address.slice(0, chars)}...${address.slice(-chars)}`;\r\n}\r\nexports.shortenAddress = shortenAddress;\r\nfunction getTokenName(map, mint, shorten = true) {\r\n    var _a;\r\n    const mintAddress = typeof mint === 'string' ? mint : mint === null || mint === void 0 ? void 0 : mint.toBase58();\r\n    if (!mintAddress) {\r\n        return 'N/A';\r\n    }\r\n    const knownSymbol = (_a = map.get(mintAddress)) === null || _a === void 0 ? void 0 : _a.symbol;\r\n    if (knownSymbol) {\r\n        return knownSymbol;\r\n    }\r\n    return shorten ? `${mintAddress.substring(0, 5)}...` : mintAddress;\r\n}\r\nexports.getTokenName = getTokenName;\r\nfunction getVerboseTokenName(map, mint, shorten = true) {\r\n    var _a;\r\n    const mintAddress = typeof mint === 'string' ? mint : mint === null || mint === void 0 ? void 0 : mint.toBase58();\r\n    if (!mintAddress) {\r\n        return 'N/A';\r\n    }\r\n    const knownName = (_a = map.get(mintAddress)) === null || _a === void 0 ? void 0 : _a.name;\r\n    if (knownName) {\r\n        return knownName;\r\n    }\r\n    return shorten ? `${mintAddress.substring(0, 5)}...` : mintAddress;\r\n}\r\nexports.getVerboseTokenName = getVerboseTokenName;\r\nfunction getTokenByName(tokenMap, name) {\r\n    let token = null;\r\n    for (const val of tokenMap.values()) {\r\n        if (val.symbol === name) {\r\n            token = val;\r\n            break;\r\n        }\r\n    }\r\n    return token;\r\n}\r\nexports.getTokenByName = getTokenByName;\r\nfunction getTokenIcon(map, mintAddress) {\r\n    var _a;\r\n    const address = typeof mintAddress === 'string' ? mintAddress : mintAddress === null || mintAddress === void 0 ? void 0 : mintAddress.toBase58();\r\n    if (!address) {\r\n        return;\r\n    }\r\n    return (_a = map.get(address)) === null || _a === void 0 ? void 0 : _a.logoURI;\r\n}\r\nexports.getTokenIcon = getTokenIcon;\r\nfunction isKnownMint(map, mintAddress) {\r\n    return !!map.get(mintAddress);\r\n}\r\nexports.isKnownMint = isKnownMint;\r\nexports.STABLE_COINS = new Set(['USDC', 'wUSDC', 'USDT']);\r\nfunction chunks(array, size) {\r\n    return Array.apply(0, new Array(Math.ceil(array.length / size))).map((_, index) => array.slice(index * size, (index + 1) * size));\r\n}\r\nexports.chunks = chunks;\r\nfunction toLamports(account, mint) {\r\n    var _a;\r\n    if (!account) {\r\n        return 0;\r\n    }\r\n    const amount = typeof account === 'number' ? account : (_a = account.info.amount) === null || _a === void 0 ? void 0 : _a.toNumber();\r\n    const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 0);\r\n    return Math.floor(amount * precision);\r\n}\r\nexports.toLamports = toLamports;\r\nfunction wadToLamports(amount) {\r\n    return (amount === null || amount === void 0 ? void 0 : amount.div(constants_1.WAD)) || constants_1.ZERO;\r\n}\r\nexports.wadToLamports = wadToLamports;\r\nfunction fromLamports(account, mint, rate = 1.0) {\r\n    if (!account) {\r\n        return 0;\r\n    }\r\n    const amount = Math.floor(typeof account === 'number'\r\n        ? account\r\n        : bn_js_1.default.isBN(account)\r\n            ? account.toNumber()\r\n            : account.info.amount.toNumber());\r\n    const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 9);\r\n    return (amount / precision) * rate;\r\n}\r\nexports.fromLamports = fromLamports;\r\nconst tryParseKey = (key) => {\r\n    try {\r\n        return new web3_js_1.PublicKey(key);\r\n    }\r\n    catch (error) {\r\n        return null;\r\n    }\r\n};\r\nexports.tryParseKey = tryParseKey;\r\nconst SI_SYMBOL = ['', 'k', 'M', 'G', 'T', 'P', 'E'];\r\nconst abbreviateNumber = (number, precision) => {\r\n    const tier = (Math.log10(number) / 3) | 0;\r\n    let scaled = number;\r\n    const suffix = SI_SYMBOL[tier];\r\n    if (tier !== 0) {\r\n        const scale = Math.pow(10, tier * 3);\r\n        scaled = number / scale;\r\n    }\r\n    return scaled.toFixed(precision) + suffix;\r\n};\r\nconst formatAmount = (val, precision = 2, abbr = true) => (abbr ? abbreviateNumber(val, precision) : val.toFixed(precision));\r\nexports.formatAmount = formatAmount;\r\nfunction formatTokenAmount(account, mint, rate = 1.0, prefix = '', suffix = '', precision = 2, abbr = false) {\r\n    if (!account) {\r\n        return '';\r\n    }\r\n    return `${[prefix]}${exports.formatAmount(fromLamports(account, mint, rate), precision, abbr)}${suffix}`;\r\n}\r\nexports.formatTokenAmount = formatTokenAmount;\r\nexports.formatUSD = new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: 'USD',\r\n});\r\nconst numberFormater = new Intl.NumberFormat('en-US', {\r\n    style: 'decimal',\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n});\r\nexports.formatNumber = {\r\n    format: (val) => {\r\n        if (!val) {\r\n            return '--';\r\n        }\r\n        return numberFormater.format(val);\r\n    },\r\n};\r\nexports.formatPct = new Intl.NumberFormat('en-US', {\r\n    style: 'percent',\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n});\r\nfunction convert(account, mint, rate = 1.0) {\r\n    var _a;\r\n    if (!account) {\r\n        return 0;\r\n    }\r\n    const amount = typeof account === 'number' ? account : (_a = account.info.amount) === null || _a === void 0 ? void 0 : _a.toNumber();\r\n    const precision = Math.pow(10, (mint === null || mint === void 0 ? void 0 : mint.decimals) || 0);\r\n    const result = (amount / precision) * rate;\r\n    return result;\r\n}\r\nexports.convert = convert;\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\nexports.sleep = sleep;\r\n//# sourceMappingURL=utils.js.map"]},"metadata":{},"sourceType":"script"}